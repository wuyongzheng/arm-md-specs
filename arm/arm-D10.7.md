## D10.7 Tag Check Faults

RWWXZR

RFYYFC

RMDVXM

IYHCSP

IRBPTM

IWTXPP

A Tag Check Fault can be configured using SCTLR\_ELx.{TCF, TCF0} to have one of the following behaviors:

- Have no effect on the PE.
- Generate a synchronous Tag Check Fault exception. For more information see Synchronous exception types.
- If FEAT\_MTE\_ASYNC is implemented, asynchronously set a bit in TFSR\_ELx or TFSRE0\_EL1.
- If FEAT\_MTE3 is implemented:
- -On a write, asynchronously set a bit in TFSR\_ELx or TFSRE0\_EL1.
- -On a read, generate a synchronous Tag Check Fault exception.

For the purpose of determining Tag Check Fault handling, an unprivileged access generated by an unprivileged memory access instruction is treated as if the access is at EL0.

If a Tag Check Fault is not configured to cause a synchronous exception, then there is no effect on either:

- The data access, that is the load or store completes unless another exception is taken.
- Any of the side effects caused by the completion of the data access.

A Tag Check Fault that is generated from a Canonical Tag Check operation is handled the same way as a Tag Check Fault generated from a Tag Check operation .

If FEAT\_SME is implemented, an implementation is only expected to perform Tag Check operations when the PE is in Streaming SVE mode if there is a similar performance impact relative to Tag Check operations performsed due to SVE and SIMD&amp;FP loads and stores that are executed when the PE is not in Streaming SVE mode.

If FEAT\_LS64WB is implemented and an LD64B or ST64B instruction accesses Inner and Outer Write-Back Cacheable, Shareable, Tagged memory, then because the instruction accesses four Tag Granules, it is possible that up to four Tag Check Faults are generated. If one or more Tag Check Faults are generated, the 64-byte atomic access does not occur and the address recorded in the FAR\_ELx is the lowest faulting address.

## D10.7.1 Asynchronous Tag Check Faults

| D VVJZM   | All statements in this section require implementation of FEAT_MTE_ASYNC.                                                                                                                                                                                                                                                                                                                                                     |
|-----------|------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|
| I RQYHY   | TFSR_ELx or TFSRE0_EL1 are the Tag Fault Status Registers.                                                                                                                                                                                                                                                                                                                                                                   |
| R RJMFQ   | ATag Fault Status Register is unchanged by a Tag Check operation that does not generate an asynchronous Tag Check Fault .                                                                                                                                                                                                                                                                                                    |
| R JNNZS   | An implicit write to a Tag Fault Status Register accessible at ELx that is caused by an asynchronous Tag Check Fault is synchronized by any of the following:                                                                                                                                                                                                                                                                |
| R SCVQH   | If an instruction that accesses memory generates both a synchronous Data Abort and an asynchronous Tag Check Fault , and the value of the bit written to the Tag Fault Status Register is 0, then the bit in the Tag Fault Status Register becomes UNKNOWN.                                                                                                                                                                  |
| R TJDMP   | If an asynchronous Tag Check Fault has not been observed in a Tag Fault Status Register, and has not been synchronized by a DSB or by the effects of SCTLR_ELx.ITSB, then when a write to a System register affecting Tag Check Fault handling occurs, the effect of the Tag Check Fault is CONSTRAINED UNPREDICTABLE between the effect of: • The old value of the System register. • The new value of the System register. |
| R CFWVW   | If SVE is implemented and a load of an element in an SVE Non-fault or SVE First-fault load instruction causes an asynchronous Tag Check Fault :                                                                                                                                                                                                                                                                              |

RKSKCL

- Abit in a Tag Fault Status Register is not set if the element is not the First active element in an SVE First-fault load instruction or any element of an SVE Non-fault load instruction.
- Abit in a Tag Fault Status Register is set if the element is the First active element of an SVE First-fault load instruction.

If SVE is implemented, it is CONSTRAINED UNPREDICTABLE whether the FFR element associated with the read of an Active element in an SVE Non-fault load, or an Active element which is not the First active element in an SVE First-fault load, R2, to location X, is set to FALSE if all of the following are true:

- Tag Check Faults are configured as asynchronous for both reads and writes.
- Aread or write RW1 to location Y causes a Tag Check Fault .
- Aread to location X causes a Tag Check Fault .
- Tag Check Faults for locations X and Y are reported in the same status bit, either:
- -TFSR\_ELx.TFy.
- -TFSRE0\_EL1.TFy.
- RW1 is in program order before R2, or is the First active element in the SVE First-fault load instruction causing R2.
- There are no other faults caused by R2 that are reported in FFR.
- There is not a DSB and an explicit write of 0 to that status bit appearing in program order between the instruction causing RW1 and the instruction causing R2.

## Chapter D11 The Guarded Control Stack

This chapter describes the Guarded Control Stack Extension. It contains the following sections:

- Introduction.
- The Guarded Control Stack.
- Procedure returns.
- Exception returns.
- Stage 1 permission model.
- Stage 2 Permission model.
- Guarded Control Stack switching.
- Guarded Control Stack exceptions.
- Guarded Control Stack data accesses.
- Detecting when FEAT\_GCS is enabled.