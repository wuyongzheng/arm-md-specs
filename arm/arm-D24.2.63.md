## D24.2.63 HCRX\_EL2, Extended Hypervisor Configuration Register

The HCRX\_EL2 characteristics are:

## Purpose

Provides configuration controls for virtualization, including defining whether various operations are trapped to EL2.

## Configuration

If EL2 is not implemented, this register is RES0 from EL3.

This register is present only when FEAT\_HCX is implemented and FEAT\_AA64 is implemented. Otherwise, direct accesses to HCRX\_EL2 are UNDEFINED.

## Attributes

HCRX\_EL2 is a 64-bit register.

## Field descriptions

<!-- image -->

## Bits [63:27]

Reserved, RES0.

## SRMASKEn, bit [26]

## When FEAT\_SRMASK is implemented:

If EL1 is using AArch64, accesses to the following registers are trapped to EL2 and reported using EC syndrome value 0x18 :

- CPACRMASK\_EL1.
- SCTLRMASK\_EL1.
- SCTLR2MASK\_EL1.
- TCRMASK\_EL1.
- TCR2MASK\_EL1.
- ACTLRMASK\_EL1, if it is implemented.

| SRMASKEn   | Meaning                                                                                                       |
|------------|---------------------------------------------------------------------------------------------------------------|
| 0b0        | EL1 accesses to the specified EL1 registers are trapped to EL2. The values in the registers are treated as 0. |
| 0b1        | This control does not cause any instructions to be trapped.                                                   |

Traps generated by this control have a lower priority than traps generated by the HFGRTR2\_EL2 and HFGWTR2\_EL2 controls.

When EL2 is not implemented or not enabled in the current Security state, the Effective value of this field is 1.

Otherwise, when the Effective value of SCR\_EL3.HXEn is 0, the Effective value of this field is 0.

The reset behavior of this field is:

- On a Warm reset:
- When the highest implemented Exception level is EL2, this field resets to '0' .
- Otherwise, this field resets to an architecturally UNKNOWN value.

## Otherwise:

Reserved, RES0.

## Bit [25]

Reserved, RES0.

## PACMEn, bit [24]

## When FEAT\_PAuth\_LR is implemented:

PACMEnable. Controls the effect of a PACM instruction at EL1 and EL0.

| PACMEn   | Meaning                                                                                        |
|----------|------------------------------------------------------------------------------------------------|
| 0b0      | The effects of PACMare disabled at EL1 and EL0, regardless of the value in any other controls. |
| 0b1      | This control does not disable the effect of PACMat EL1 and EL0.                                |

The Effective value of this field is 1 when any of the following are true:

- EL2 is not implemented or not enabled in the current Security state.
- The Effective value of HCR\_EL2.{E2H, TGE} is {1, 1}.

The Effective value of this field is 0 when all of the following are true:

- EL2 is implemented and enabled in the current Security state.
- The Effective value of HCR\_EL2.{E2H, TGE} is not {1, 1}.
- The Effective value of SCR\_EL3.HXEn is 0.

The reset behavior of this field is:

- On a Warm reset:
- When the highest implemented Exception level is EL2, this field resets to '0' .
- Otherwise, this field resets to an architecturally UNKNOWN value.

## Otherwise:

Reserved, RES0.

## EnFPM, bit [23]

## When FEAT\_FPMR is implemented:

Enables direct and indirect accesses to FPMR from EL0 and EL1.

When accesses to FPMR are disabled by this control:

- Direct accesses to FPMR from EL0 and EL1 are trapped to EL2 and reported using EC syndrome value 0x18 .
- Execution of FP8 data-processing instructions that indirectly access FPMR is UNDEFINED at EL0 and EL1.

| EnFPM   | Meaning                                                          |
|---------|------------------------------------------------------------------|
| 0b0     | Direct and indirect accesses to FPMRare disabled at EL1 and EL0. |
| 0b1     | This control does not cause any instructions to be trapped.      |

Traps are not taken if there is a higher priority exception generated by the access.

The Effective value of this field is 1 when any of the following are true:

- EL2 is not implemented or not enabled in the current Security state.
- The Effective value of HCR\_EL2.{E2H, TGE} is {1, 1}.

The Effective value of this field is 0 when all of the following are true:

- EL2 is implemented and enabled in the current Security state.
- The Effective value of HCR\_EL2.{E2H, TGE} is not {1, 1}.
- The Effective value of SCR\_EL3.HXEn is 0.

The reset behavior of this field is:

- On a Warm reset:
- When the highest implemented Exception level is EL2, this field resets to '0' .
- Otherwise, this field resets to an architecturally UNKNOWN value.

## Otherwise:

Reserved, RES0.

## GCSEn, bit [22]

## When FEAT\_GCS is implemented:

Guarded Control Stack enable. Controls Guarded Control Stack behavior at EL1 and EL0.

| GCSEn   | Meaning                                                                     |
|---------|-----------------------------------------------------------------------------|
| 0b0     | The Guarded Control Stack is disabled at EL1 and EL0.                       |
| 0b1     | Guarded Control Stack behavior at EL1 and EL0 is not affected by mechanism. |

The Effective value of this field is 1 when any of the following are true:

- EL2 is not implemented or not enabled in the current Security state.
- The Effective value of HCR\_EL2.{E2H, TGE} is {1, 1}.

The Effective value of this field is 0 when all of the following are true:

- EL2 is implemented and enabled in the current Security state.
- The Effective value of HCR\_EL2.{E2H, TGE} is not {1, 1}.
- The Effective value of SCR\_EL3.HXEn is 0.

The reset behavior of this field is:

- On a Warm reset:
- When the highest implemented Exception level is EL2, this field resets to '0' .
- Otherwise, this field resets to an architecturally UNKNOWN value.

## Otherwise:

Reserved, RES0.

## EnIDCP128, bit [21]

## When FEAT\_SYSREG128 is implemented:

Enables access to IMPLEMENTATION DEFINED 128-bit System registers.

| EnIDCP128   | Meaning                                                                                                                                                                                                                                                                                          |
|-------------|--------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|
| 0b0         | Accesses at EL1, EL0 to IMPLEMENTATION DEFINED 128-bit System registers are trapped to EL2 using EC syndrome value 0x14 , unless the access generates a higher priority exception. Disables the functionality of the 128-bit IMPLEMENTATION DEFINED System registers that are accessible at EL2. |
| 0b1         | No accesses are trapped by this control.                                                                                                                                                                                                                                                         |

The Effective value of this field is 1 when any of the following are true:

- EL2 is not implemented or not enabled in the current Security state.
- The Effective value of HCR\_EL2.{E2H, TGE} is {1, 1}.

The Effective value of this field is 0 when all of the following are true:

- EL2 is implemented and enabled in the current Security state.
- The Effective value of HCR\_EL2.{E2H, TGE} is not {1, 1}.
- The Effective value of SCR\_EL3.HXEn is 0.

The reset behavior of this field is:

- On a Warm reset:
- When the highest implemented Exception level is EL2, this field resets to '0' .
- Otherwise, this field resets to an architecturally UNKNOWN value.

## Otherwise:

Reserved, RES0.

## EnSDERR, bit [20]

## When FEAT\_ADERR is implemented:

Enable Synchronous Device Read Error. Override SCTLR2\_EL1.EnADERR.

| EnSDERR   | Meaning                                                                                                           |
|-----------|-------------------------------------------------------------------------------------------------------------------|
| 0b0       | This field has no effect on External aborts on Device memory reads in the EL1&0 translation regime.               |
| 0b1       | External abort on Device memory reads generate synchronous Data Abort exceptions in the EL1&0 translation regime. |

Implementation-specific exceptions to applications of this field are described in 'Taking error exceptions'.

Setting this field to 1 does not guarantee that the PE is able to take a synchronous Data Abort exception for an External abort on a Device memory read in every case. There might be implementation-specific circumstances when an error on a load cannot be taken synchronously. These circumstances should be rare enough that treating such occurrences as fatal does not cause a significant increase in failure rate.

If FEAT\_SVE is implemented, HCRX\_EL2.EnSDERR is 1, and the access generating the External abort is due to any Active element of an SVE Non-fault vector load instruction or an Active element that is not the First active element of an SVE First-fault vector load instruction, then no exception is generated and the External abort is reported in the FFR.

Setting this field to 1 might have a performance impact for Device memory reads.

This field is ignored by the PE and has an Effective value of 0 when any of the following are true:

- All of the following are true:
- FEAT\_ANERR is implemented.
- ID\_AA64MMFR3\_EL1.ADERR reads as 0b0010 .
- HCRX\_EL2.{EnSDERR, EnSNERR} == {1, 0}.
- The Effective value of SCR\_EL3.HXEn is 0.
- The Effective value of HCR\_EL2.{E2H, TGE} is {1, 1}.
- EL2 is not implemented or not enabled in the current Security state.

The reset behavior of this field is:

- On a Warm reset:
- When the highest implemented Exception level is EL2, this field resets to '0' .
- Otherwise, this field resets to an architecturally UNKNOWN value.

## Otherwise:

Reserved, RES0.

## TMEA, bit [19]

## When FEAT\_DoubleFault2 is implemented:

Trap Masked External Aborts. Controls whether a masked error exception at a lower Exception level is taken to EL2.

| TMEA   | Meaning                                                                                                                                                                                                                                                                                                  |
|--------|----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|
| 0b0    | Synchronous External abort exceptions, physical SError exceptions, and delegated SError exceptions at EL1 and EL0 are unaffected by this mechanism. That is, these exceptions are not taken to EL2 unless routed to EL2 by another control. Virtual SError exceptions are not enabled by this mechanism. |

| TMEA   | Meaning                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                               |
|--------|-----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|
| 0b1    | When executing at Exception levels below EL2, if EL2 is enabled in the current Security state, then all of the following apply: • When PSTATE.A is 1, synchronous External abort exceptions are taken to EL2, unless they are routed to EL3. • Masked physical SError exceptions are taken to EL2, unless they are routed to EL3. • If FEAT_E3DSE is implemented, then masked delegated SError exceptions enabled by SCR_EL3.DSE are taken to EL2. • If HCR_EL2.TGE is 0, then virtual SError exceptions are enabled. |

The Effective value of this field is 0 when any of the following are true:

- The Effective value of SCR\_EL3.HXEn is 0.
- The Effective value of HCR\_EL2.{E2H, TGE} is {1, 1}.
- EL2 is not implemented or not enabled in the current Security state.

Virtual SError exceptions are disabled when the Effective value of HCR\_EL2.AMO is 0 and the Effective value of HCRX\_EL2.TMEA is 0.

The reset behavior of this field is:

- On a Warm reset:
- When the highest implemented Exception level is EL2, this field resets to '0' .
- Otherwise, this field resets to an architecturally UNKNOWN value.

## Otherwise:

Reserved, RES0.

## EnSNERR, bit [18]

## When FEAT\_ANERR is implemented:

Enable Synchronous Normal Read Error. Override SCTLR2\_EL1.EnANERR.

| EnSNERR   | Meaning                                                                                                           |
|-----------|-------------------------------------------------------------------------------------------------------------------|
| 0b0       | This field has no effect on External aborts on Normal memory reads in the EL1&0 translation regime.               |
| 0b1       | External abort on Normal memory reads generate synchronous Data Abort exceptions in the EL1&0 translation regime. |

Implementation-specific exceptions to applications of this field are described in 'Taking error exceptions'.

Setting this field to 1 does not guarantee that the PE is able to take a synchronous Data Abort exception for an External abort on a Normal memory read in every case. There might be implementation-specific circumstances when an error on a load cannot be taken synchronously. These circumstances should be rare enough that treating such occurrences as fatal does not cause a significant increase in failure rate.

If FEAT\_SVE is implemented, HCRX\_EL2.EnSNERR is 1, and the access generating the External abort is due to any Active element of an SVE Non-fault vector load instruction or an Active element that is not the First active element of an SVE First-fault vector load instruction, then no exception is generated and the External abort is reported in the FFR.

Setting this field to 1 might have a performance impact for Normal memory reads.

This field is ignored by the PE and has an Effective value of 0 when any of the following are true:

- All of the following are true:
- FEAT\_ADERR is implemented.
- ID\_AA64MMFR3\_EL1.ANERR reads as 0b0010 .
- HCRX\_EL2.{EnSDERR, EnSNERR} == {0, 1}.
- The Effective value of SCR\_EL3.HXEn is 0.
- The Effective value of HCR\_EL2.{E2H, TGE} is {1, 1}.
- EL2 is not implemented or not enabled in the current Security state.

The reset behavior of this field is:

- On a Warm reset:
- When the highest implemented Exception level is EL2, this field resets to '0' .
- Otherwise, this field resets to an architecturally UNKNOWN value.

## Otherwise:

Reserved, RES0.

## D128En, bit [17]

## When FEAT\_D128 is implemented:

128-bit System Register trap control. Enable access to 128-bit System Registers that relate to VMSAv9-128 via MRRS , MSRR instructions.

If EL1 is using AArch64, accesses to the following registers are trapped to EL2 and reported using EC syndrome value 0x14 :

- TTBR0\_EL1.
- TTBR1\_EL1.
- If FEAT\_THE is implemented, RCWMASK\_EL1, RCWSMASK\_EL1.
- PAR\_EL1.

| D128En   | Meaning                                                                   |
|----------|---------------------------------------------------------------------------|
| 0b0      | EL1 accesses to the specified registers are disabled, and trapped to EL2. |
| 0b1      | This control does not cause any instructions to be trapped.               |

When EL2 is not implemented or not enabled in the current Security state, the Effective value of this field is 1.

Otherwise, when the Effective value of SCR\_EL3.HXEn is 0, the Effective value of this field is 0.

The reset behavior of this field is:

- On a Warm reset:
- When the highest implemented Exception level is EL2, this field resets to '0' .
- Otherwise, this field resets to an architecturally UNKNOWN value.

## Otherwise:

Reserved, RES0.

## PTTWI, bit [16]

## When FEAT\_THE is implemented:

Permit Translation Table Walk Incoherence.

Permits RCWS instructions to generate writes that have the Reduced Coherence property.

| PTTWI   | Meaning                                                                                                           |
|---------|-------------------------------------------------------------------------------------------------------------------|
| 0b0     | Write accesses generated by RCWSat EL1 and EL0 do not have the Reduced Coherence property.                        |
| 0b1     | Write accesses generated by RCWSat EL1 and EL0 have the Reduced Coherence property, if enabled by TCR2_EL1.PTTWI. |

The Effective value of this field is 1 when any of the following are true:

- EL2 is not implemented or not enabled in the current Security state.
- The Effective value of HCR\_EL2.{E2H, TGE} is {1, 1}.

The Effective value of this field is 0 when all of the following are true:

- EL2 is implemented and enabled in the current Security state.
- The Effective value of HCR\_EL2.{E2H, TGE} is not {1, 1}.
- The Effective value of SCR\_EL3.HXEn is 0.

This field is permitted to be cached in TLB.

This field is permitted to be implemented as a read-only field with a fixed value of 0.

The reset behavior of this field is:

- On a Warm reset:
- When the highest implemented Exception level is EL2, this field resets to '0' .
- Otherwise, this field resets to an architecturally UNKNOWN value.

## Otherwise:

Reserved, RES0.

## SCTLR2En, bit [15]

## When FEAT\_SCTLR2 is implemented:

SCTLR2\_EL1 Enable. In AArch64 state, accesses to SCTLR2\_EL1 are trapped to EL2 and reported using EC syndrome value 0x18 .

| SCTLR2En   | Meaning                                                                                                                                             |
|------------|-----------------------------------------------------------------------------------------------------------------------------------------------------|
| 0b0        | Accesses to SCTLR2_EL1 at EL1 are trapped to EL2, unless the access generates a higher priority exception. The value in SCTLR2_EL1 is treated as 0. |
| 0b1        | This control does not cause any instructions to be trapped.                                                                                         |

When EL2 is not implemented or not enabled in the current Security state, the Effective value of this field is 1.

Otherwise, when the Effective value of SCR\_EL3.HXEn is 0, the Effective value of this field is 0.

The reset behavior of this field is:

- On a Warm reset:
- When the highest implemented Exception level is EL2, this field resets to '0' .
- Otherwise, this field resets to an architecturally UNKNOWN value.

## Otherwise:

Reserved, RES0.

## TCR2En, bit [14]

## When FEAT\_TCR2 is implemented:

TCR2\_EL1 Enable. In AArch64 state, accesses to TCR2\_EL1 are trapped to EL2 and reported using EC syndrome value 0x18 .

| TCR2En   | Meaning                                                                                                                                         |
|----------|-------------------------------------------------------------------------------------------------------------------------------------------------|
| 0b0      | Accesses to TCR2_EL1 at EL1 are trapped to EL2, unless the access generates a higher priority exception. The value in TCR2_EL1 is treated as 0. |
| 0b1      | This control does not cause any instructions to be trapped.                                                                                     |

When EL2 is not implemented or not enabled in the current Security state, the Effective value of this field is 1.

Otherwise, when the Effective value of SCR\_EL3.HXEn is 0, the Effective value of this field is 0.

The reset behavior of this field is:

- On a Warm reset:
- When the highest implemented Exception level is EL2, this field resets to '0' .
- Otherwise, this field resets to an architecturally UNKNOWN value.

## Otherwise:

Reserved, RES0.

## Bits [13:12]

Reserved, RES0.

## MSCEn, bit [11]

## When FEAT\_MOPS is implemented:

Memory Set and Memory Copy instructions Enable. Enables execution of the CPY*, SETG*, SETP*, SETM*, and SETE* instructions at EL1 or EL0.

| MSCEn   | Meaning                                                                              |
|---------|--------------------------------------------------------------------------------------|
| 0b0     | Execution of the Memory Copy and Memory Set instructions is UNDEFINED at EL1 or EL0. |
| 0b1     | This control does not cause any instructions to be UNDEFINED.                        |

The Effective value of this field is 1 when any of the following are true:

- EL2 is not implemented or not enabled in the current Security state.
- The Effective value of HCR\_EL2.{E2H, TGE} is {1, 1}.

The Effective value of this field is 0 when all of the following are true:

- EL2 is implemented and enabled in the current Security state.
- The Effective value of HCR\_EL2.{E2H, TGE} is not {1, 1}.
- The Effective value of SCR\_EL3.HXEn is 0.

The reset behavior of this field is:

- On a Warm reset:
- When the highest implemented Exception level is EL2, this field resets to '0' .
- Otherwise, this field resets to an architecturally UNKNOWN value.

## Otherwise:

Reserved, RES0.

## MCE2, bit [10]

## When FEAT\_MOPS is implemented:

Controls Memory Copy and Memory Set exceptions generated as part of attempting to execute the Memory Copy and Memory Set instructions from EL1.

| MCE2   | Meaning                                                                    |
|--------|----------------------------------------------------------------------------|
| 0b0    | Memory Copy and Memory Set exceptions generated from EL1 are taken to EL1. |
| 0b1    | Memory Copy and Memory Set exceptions generated from EL1 are taken to EL2. |

The Effective value of this field is 0 when any of the following are true:

- EL2 is not implemented or not enabled in the current Security state.
- The Effective value of SCR\_EL3.HXEn is 0.

The reset behavior of this field is:

- On a Warm reset:
- When the highest implemented Exception level is EL2, this field resets to '0' .
- Otherwise, this field resets to an architecturally UNKNOWN value.

## Otherwise:

Reserved, RES0.

## CMOW,bit [9]

## When FEAT\_CMOWis implemented:

Controls the required permissions for the following cache maintenance instructions executed at EL1 or EL0:

- Any DC instruction that operates by V A and performs a clean and invalidate operation.
- Any IC instruction that operates by V A.

| CMOW   | Meaning                                                                                                                            |
|--------|------------------------------------------------------------------------------------------------------------------------------------|
| 0b0    | This control does not cause any instructions to generate a stage 2 Permission fault.                                               |
| 0b1    | For these instructions, when executed at EL1 or EL0, the absence of stage 2 write permission generates a stage 2 permission fault. |

For more information, see:

- Stage 2 permissions.
- Implications of enabling the dirty state management mechanism.

The Effective value of this field is 0 when any of the following are true:

- The Effective value of SCR\_EL3.HXEn is 0.
- The Effective value of HCR\_EL2.{E2H, TGE} is {1, 1}.
- EL2 is not implemented or not enabled in the current Security state.

This field is permitted to be cached in a TLB.

The reset behavior of this field is:

- On a Warm reset:
- When the highest implemented Exception level is EL2, this field resets to '0' .
- Otherwise, this field resets to an architecturally UNKNOWN value.

## Otherwise:

Reserved, RES0.

## VFNMI, bit [8]

## When FEAT\_NMI is implemented:

Virtual FIQ Interrupt with Superpriority. Enables signaling of virtual FIQ interrupts with Superpriority.

| VFNMI   | Meaning                                                                                     |
|---------|---------------------------------------------------------------------------------------------|
| 0b0     | When HCR_EL2.VF is 1, a signaled pending virtual FIQ interrupt does not have Superpriority. |
| 0b1     | When HCR_EL2.VF is 1, a signaled pending virtual FIQ interrupt has Superpriority.           |

When HCR\_EL2.VF is 0, this field has no effect.

The Effective value of this field is 0 when any of the following are true:

- EL2 is not implemented or not enabled in the current Security state.
- The Effective value of SCR\_EL3.HXEn is 0.

The reset behavior of this field is:

- On a Warm reset:
- When the highest implemented Exception level is EL2, this field resets to '0' .
- Otherwise, this field resets to an architecturally UNKNOWN value.

## Otherwise:

Reserved, RES0.

## VINMI, bit [7]

## When FEAT\_NMI is implemented:

Virtual IRQ Interrupt with Superpriority. Enables signaling of virtual IRQ interrupts with Superpriority.

| VINMI   | Meaning                                                                                     |
|---------|---------------------------------------------------------------------------------------------|
| 0b0     | When HCR_EL2.VI is 1, a signaled pending virtual IRQ interrupt does not have Superpriority. |
| 0b1     | When HCR_EL2.VI is 1, a signaled pending virtual IRQ interrupt has Superpriority.           |

When HCR\_EL2.VI is 0, this field has no effect.

The Effective value of this field is 0 when any of the following are true:

- EL2 is not implemented or not enabled in the current Security state.
- The Effective value of SCR\_EL3.HXEn is 0.

The reset behavior of this field is:

- On a Warm reset:
- When the highest implemented Exception level is EL2, this field resets to '0' .
- Otherwise, this field resets to an architecturally UNKNOWN value.

## Otherwise:

Reserved, RES0.

## TALLINT, bit [6]

## When FEAT\_NMI is implemented:

Traps the following writes at EL1 using AArch64 to EL2, when EL2 is implemented and enabled:

- MSR(register) writes of ALLINT.
- MSR(immediate) writes of ALLINT with a value of 1.

| TALLINT   | Meaning                                                            |
|-----------|--------------------------------------------------------------------|
| 0b0       | This control does not cause any instructions to be trapped.        |
| 0b1       | The specified MSRaccesses at EL1 using AArch64 are trapped to EL2. |

The Effective value of this field is 0 when any of the following are true:

- EL2 is not implemented or not enabled in the current Security state.
- The Effective value of SCR\_EL3.HXEn is 0.

The reset behavior of this field is:

- On a Warm reset:
- When the highest implemented Exception level is EL2, this field resets to '0' .
- Otherwise, this field resets to an architecturally UNKNOWN value.

## Otherwise:

Reserved, RES0.

## SMPME,bit [5]

## When FEAT\_SME is implemented:

Streaming Mode Priority Mapping Enable.

Controls mapping of the value of SMPRI\_EL1.Priority for streaming execution priority at EL0 or EL1.

| SMPME   | Meaning                                                                                                                                                                                                                                                     |
|---------|-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|
| 0b0     | The effective priority value is taken from SMPRI_EL1.Priority.                                                                                                                                                                                              |
| 0b1     | The effective priority value is: • When the current Exception level is EL2 or EL3, the value of SMPRI_EL1.Priority. • When the current Exception level is EL0 or EL1, the value of the SMPRIMAP_EL2 field corresponding to the value of SMPRI_EL1.Priority. |

When SMIDR\_EL1.SMPS is '0', this field is RES0.

The Effective value of this field is 0 when any of the following are true:

- The Effective value of SCR\_EL3.HXEn is 0.

- The Effective value of HCR\_EL2.{E2H, TGE} is {1, 1}.
- EL2 is not implemented or not enabled in the current Security state.

The reset behavior of this field is:

- On a Warm reset:
- When the highest implemented Exception level is EL2, this field resets to '0' .
- Otherwise, this field resets to an architecturally UNKNOWN value.

## Otherwise:

Reserved, RES0.

## FGTnXS, bit [4]

## When FEAT\_XS is implemented:

Determines if the fine-grained traps in HFGITR\_EL2 that apply to each of the TLBI maintenance instructions that are accessible at EL1 also apply to the corresponding TLBI maintenance instructions with the nXS qualifier.

| FGTnXS   | Meaning                                                                                                                                                                           |
|----------|-----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|
| 0b0      | The fine-grained trap in the HFGITR_EL2 that applies to a TLBI maintenance instruction at EL1 also applies to the corresponding TLBI instruction with the nXS qualifier at EL1.   |
| 0b1      | The fine-grained trap in the HFGITR_EL2 that applies to a TLBI maintenance instruction at EL1 does not apply to the corresponding TLBI instruction with the nXS qualifier at EL1. |

The Effective value of this field is 0 when any of the following are true:

- EL2 is not implemented or not enabled in the current Security state.
- The Effective value of SCR\_EL3.HXEn is 0.

The reset behavior of this field is:

- On a Warm reset:
- When the highest implemented Exception level is EL2, this field resets to '0' .
- Otherwise, this field resets to an architecturally UNKNOWN value.

## Otherwise:

Reserved, RES0.

## FnXS, bit [3]

## When FEAT\_XS is implemented:

Determines the behavior of TLBI instructions affected by the XS attribute.

This control field also determines whether an AArch64 DSB instruction behaves as a DSB instruction with an nXS qualifier when executed at EL0 and EL1.

| FnXS   | Meaning                                                                                     |
|--------|---------------------------------------------------------------------------------------------|
| 0b0    | This control does not have any effect on the behavior of the TLBI maintenance instructions. |

| FnXS   | Meaning                                                                                                                                                                                                                                                                                                                                                                       |
|--------|-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|
| 0b1    | ATLBI maintenance instruction without the nXS qualifier executed at EL1 behaves in the same way as the corresponding TLBI maintenance instruction with the nXS qualifier. An AArch64 DSB instruction that applies to both loads and stores executed at EL1 or EL0 behaves in the same way as the corresponding DSB instruction with the nXS qualifier executed at EL1 or EL0. |

The Effective value of this field is 0 when any of the following are true:

- EL2 is not implemented or not enabled in the current Security state.
- The Effective value of SCR\_EL3.HXEn is 0.

This field is permitted to be cached in a TLB.

The reset behavior of this field is:

- On a Warm reset:
- When the highest implemented Exception level is EL2, this field resets to '0' .
- Otherwise, this field resets to an architecturally UNKNOWN value.

## Otherwise:

Reserved, RES0.

## EnASR, bit [2]

## When FEAT\_LS64\_V is implemented:

When the Effective value of HCR\_EL2.{E2H, TGE} is not {1, 1}, traps execution of an ST64BV instruction at EL0 or EL1 to EL2.

| EnASR   | Meaning                                                                                                                                                                      |
|---------|------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|
| 0b0     | Execution of an ST64BV instruction at EL0 is trapped to EL2 if the execution is not trapped by SCTLR_EL1.EnASR. Execution of an ST64BV instruction at EL1 is trapped to EL2. |
| 0b1     | This control does not cause any instructions to be trapped.                                                                                                                  |

Atrap of an ST64BV instruction is reported using EC syndrome value 0x0A , with an ISS code of 0x0000000 .

The Effective value of this field is 1 when any of the following are true:

- EL2 is not implemented or not enabled in the current Security state.
- The Effective value of HCR\_EL2.{E2H, TGE} is {1, 1}.

The Effective value of this field is 0 when all of the following are true:

- EL2 is implemented and enabled in the current Security state.
- The Effective value of HCR\_EL2.{E2H, TGE} is not {1, 1}.
- The Effective value of SCR\_EL3.HXEn is 0.

The reset behavior of this field is:

- On a Warm reset:
- When the highest implemented Exception level is EL2, this field resets to '0' .
- Otherwise, this field resets to an architecturally UNKNOWN value.

## Otherwise:

Reserved, RES0.

## EnALS, bit [1]

## When FEAT\_LS64 is implemented:

When the Effective value of HCR\_EL2.{E2H, TGE} is not {1, 1}, traps execution of an LD64B or ST64B instruction at EL0 or EL1 to EL2.

| EnALS   | Meaning                                                                                                                                                                                      |
|---------|----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|
| 0b0     | Execution of an LD64B or ST64B instruction at EL0 is trapped to EL2 if the execution is not trapped by SCTLR_EL1.EnALS. Execution of an LD64B or ST64B instruction at EL1 is trapped to EL2. |
| 0b1     | This control does not cause any instructions to be trapped.                                                                                                                                  |

Atrap of an LD64B or ST64B instruction is reported using EC syndrome value 0x0A , with an ISS code of 0x0000002 .

The Effective value of this field is 1 when any of the following are true:

- EL2 is not implemented or not enabled in the current Security state.
- The Effective value of HCR\_EL2.{E2H, TGE} is {1, 1}.

The Effective value of this field is 0 when all of the following are true:

- EL2 is implemented and enabled in the current Security state.
- The Effective value of HCR\_EL2.{E2H, TGE} is not {1, 1}.
- The Effective value of SCR\_EL3.HXEn is 0.

The reset behavior of this field is:

- On a Warm reset:
- When the highest implemented Exception level is EL2, this field resets to '0' .
- Otherwise, this field resets to an architecturally UNKNOWN value.

## Otherwise:

Reserved, RES0.

## EnAS0, bit [0]

## When FEAT\_LS64\_ACCDATA is implemented:

When the Effective value of HCR\_EL2.{E2H, TGE} is not {1, 1}, traps execution of an ST64BV0 instruction at EL0 or EL1 to EL2.

| EnAS0   | Meaning                                                                                                                                                                        |
|---------|--------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|
| 0b0     | Execution of an ST64BV0 instruction at EL0 is trapped to EL2 if the execution is not trapped by SCTLR_EL1.EnAS0. Execution of an ST64BV0 instruction at EL1 is trapped to EL2. |
| 0b1     | This control does not cause any instructions to be trapped.                                                                                                                    |

Atrap of an ST64BV0 instruction is reported using EC syndrome value 0x0A , with an ISS code of 0x0000001 .

The Effective value of this field is 1 when any of the following are true:

- EL2 is not implemented or not enabled in the current Security state.

- The Effective value of HCR\_EL2.{E2H, TGE} is {1, 1}.

The Effective value of this field is 0 when all of the following are true:

- EL2 is implemented and enabled in the current Security state.
- The Effective value of HCR\_EL2.{E2H, TGE} is not {1, 1}.
- The Effective value of SCR\_EL3.HXEn is 0.

The reset behavior of this field is:

- On a Warm reset:
- When the highest implemented Exception level is EL2, this field resets to '0' .
- Otherwise, this field resets to an architecturally UNKNOWN value.

## Otherwise:

Reserved, RES0.

## Accessing HCRX\_EL2

Accesses to this register use the following encodings in the System register encoding space:

MRS &lt;Xt&gt;, HCRX\_EL2

| op0   | op1   | CRn    | CRm    | op2   |
|-------|-------|--------|--------|-------|
| 0b11  | 0b100 | 0b0001 | 0b0010 | 0b010 |

```
if !(IsFeatureImplemented(FEAT_HCX) && IsFeatureImplemented(FEAT_AA64)) then UNDEFINED; elsif PSTATE.EL == EL0 then UNDEFINED; elsif PSTATE.EL == EL1 then if EffectiveHCR_EL2_NVx() IN {'1x1'} then X[t, 64] = NVMem[0x0A0]; elsif EffectiveHCR_EL2_NVx() IN {'xx1'} then AArch64.SystemAccessTrap(EL2, 0x18); else UNDEFINED; elsif PSTATE.EL == EL2 then if HaveEL(EL3) && EL3SDDUndefPriority() && SCR_EL3.HXEn == '0' then UNDEFINED; elsif HaveEL(EL3) && SCR_EL3.HXEn == '0' then if EL3SDDUndef() then UNDEFINED; else AArch64.SystemAccessTrap(EL3, 0x18); else X[t, 64] = HCRX_EL2; elsif PSTATE.EL == EL3 then X[t, 64] = HCRX_EL2;
```

MSR HCRX\_EL2, &lt;Xt&gt;

| op0   | op1   | CRn    | CRm    | op2   |
|-------|-------|--------|--------|-------|
| 0b11  | 0b100 | 0b0001 | 0b0010 | 0b010 |

```
if !(IsFeatureImplemented(FEAT_HCX) && IsFeatureImplemented(FEAT_AA64)) then UNDEFINED; elsif PSTATE.EL == EL0 then UNDEFINED; elsif PSTATE.EL == EL1 then if EffectiveHCR_EL2_NVx() IN {'1x1'} then NVMem[0x0A0] = X[t, 64]; elsif EffectiveHCR_EL2_NVx() IN {'xx1'} then AArch64.SystemAccessTrap(EL2, 0x18); else UNDEFINED; elsif PSTATE.EL == EL2 then if HaveEL(EL3) && EL3SDDUndefPriority() && SCR_EL3.HXEn == '0' then UNDEFINED; elsif HaveEL(EL3) && SCR_EL3.HXEn == '0' then if EL3SDDUndef() then UNDEFINED; else AArch64.SystemAccessTrap(EL3, 0x18); else HCRX_EL2 = X[t, 64]; elsif PSTATE.EL == EL3 then HCRX_EL2 = X[t, 64];
```