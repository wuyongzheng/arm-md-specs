## H3.5 External Debug Request debug event

External Debug Request debug events are asynchronous debug events.

An External Debug Request debug event can be generated by any of the following:

- When signaled by the embedded cross-trigger. See The Embedded Cross-Trigger Interface.
- The trace unit. See ETE external debug request.
- The Trace Buffer Unit. See Trace Buffer Unit external debug request.
- The Performance Monitoring Unit. See PMU Overflow external debug request.
- An implementation might also support IMPLEMENTATION DEFINED ways of generating an External Debug Request debug event.

## H3.5.1 Synchronization and External Debug Request debug events

For all Context synchronization events, if an External Debug Request debug event is asserted before the Context Synchronization event, and the External Debug Request debug event remains asserted and halting is allowed after the Context synchronization event, then the debug event is taken and the PE enters Debug state before the first instruction following the Context synchronization event completes its execution.

An External Debug Request debug event that is being asserted when the PE comes out of reset is taken, and the PE enters Debug state before the first instruction after the reset completes its execution, provided that halting is allowed when the PE exits reset state.

If the first instruction after the Context Synchronization event or after coming out of reset generates a synchronous exception then the architecture does not define the order in which the debug event and the exception or exceptions are taken.

Otherwise, when all of the following are true, External Debug Request debug events must be taken in finite time, without requiring the synchronization of any necessary change to the external authentication interface:

- Halting is allowed.
- The PE is not in a low-power state that is not required to exit on an external debug request. See Core power domain power states.

External debug request is a wakeup event for WFI , WFIT , WFE , or WFET instructions. See Mechanisms for entering a low-power state.

Note

These rules are based on the rules that apply when taking asynchronous exceptions. See Asynchronous exception types.

If an unmasked External Debug Request debug event was pending but is changed to not pending before it is taken, then the architecture permits the External Debug Request debug event to be taken, but does not require this to happen. If the External Debug Request debug event is taken then it must be taken before the first Context Synchronization event after the External Debug Request debug event was changed to not pending.

Example H3-3 shows an example of the synchronization requirements.

Example H3-3 Synchronization requirements

Secure software locks up in a tight loop, so it executes indefinitely without any synchronization operations. An External debug request must be able to break the PE out of that loop. This is a requirement even if DBGEN or SPIDEN or both are LOW on entry to the loop, meaning that halting is prohibited, and are only asserted HIGH later.

## H3.5.2 ETE external debug request

If FEAT\_Debugv8p9 and FEAT\_ETEv1p3 are implemented, and all of the following are true, the PE halts and enters Debug state:

- EDECR.TRCE is 1.
- ETEEvent 0 occurs.
- Halting is allowed.

When the PE halts and enters Debug state due to an ETE external debug request:

- DLR\_EL0 is set to the address of the first instruction that must be executed on exit from Debug state. DSPSR\_EL0 is correct for this instruction.
- EDSCR.STATUS is set to 0b010011 , external debug request.

See also Trace Buffer Unit external debug request.

## H3.5.3 Trace Buffer Unit external debug request

When FEAT\_Debugv8p9 and FEAT\_TRBE\_EXT are implemented, and all of the following apply, the PE halts and enters Debug state:

- EDECR.TRBE is 1.
- The Trace Buffer Unit is enabled.
- TRBSR\_EL1.IRQ is 1.
- Halting is allowed.

Note

The Trace Buffer Unit is not required to be using External mode.

When the PE halts and enters Debug state due to a Trace Buffer Unit external debug request:

- DLR\_EL0 is set to the address of the first instruction that must be executed on exit from Debug state. DSPSR\_EL0 is correct for this instruction.
- EDSCR.STATUS is set to 0b010011 , external debug request.

## H3.5.4 PMU Overflow external debug request

When FEAT\_Debugv8p9 and FEAT\_PMUv3p9 are implemented and all of the following are true, the PE halts and enters Debug state:

- EDECR.PME is 1.
- Any of the following are true:
- -An event counter &lt;n&gt; is implemented, the global enable control for the event counter is 1, PMINTENSET\_EL1.P&lt;n&gt; is 1, and PMOVSSET\_EL0.P&lt;n&gt; is 1.
- -PMCR\_EL0.E is 1, PMINTENSET\_EL1.C is 1, and PMOVSSET\_EL0.C is 1.
- -FEAT\_PMUv3\_ICNTR is implemented, PMCR\_EL0.E is 1, PMINTENSET\_EL1.F0 is 1, and PMOVSSET\_EL0.F0 is 1.

That is, the Performance Monitors overflow trigger event is asserted.

- Halting is allowed.

Note

If FEAT\_SEBEP is implemented, PMEVTYPER&lt;n&gt;\_EL0.SYNC is ignored and the halt is not required to be synchronous under any circumstances.

When the PE halts and enters Debug state because of a PMU Overflow external debug request:

- DLR\_EL0 is set to the address of the first instruction that must be executed on exit from Debug state. DSPSR\_EL0 is correct for this instruction.
- EDSCR.STATUS is set to 0b010011 , external debug request.

## H3.5.5 Pseudocode description of External Debug Request debug events

The ExternalDebugRequest() function is described in A-profile Architecture Pseudocode.