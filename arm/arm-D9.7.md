## D9.7 GPT lookup process

| R NGQRV   | All accesses made by the MMUtothe GPT are 64-bit single-copy atomic.                                                 |
|-----------|----------------------------------------------------------------------------------------------------------------------|
| R QNGFY   | Tables at each GPT level are indexed by the input PA bits, according to the values of GPCCR_EL3.{PPS, PGS, L0GPTSZ}. |
| I GRXPD   | The following table describes how the index information from a PA input is decoded into the GPT lookup:              |

| PA bits         | Interpretation                                        |
|-----------------|-------------------------------------------------------|
| PA[51: t ]      | Only applies if t < 52. Checked against GPCCR_EL3.PPS |
| PA[ t -1: s ]   | Index into level 0 table                              |
| PA[ s -1: p +4] | Index into level 1 table                              |
| PA[ p +3: p ]   | Index of GPI within level 1 table entry               |

## Where:

- The bit position t has the same value as the configured protected PA size, decoded from GPCCR\_EL3.PPS.
- The bit position s has the same value as the supported L0GPT entry size, decoded from GPCCR\_EL3.L0GPTSZ.
- The bit position p has the same value as the address width of the physical granule size configured in GPCCR\_EL3.PGS:
- -0b00 , 4KB, p = 12
- -0b10 , 16KB, p = 14
- -0b01 , 64KB, p = 16

RRDYKY

The following table describes how the level 0 table is indexed by PA bits:

| GPCCR_EL3.PPS[3:0]                                    | Level 0 index   |
|-------------------------------------------------------|-----------------|
| 0b0000                                                | PA[31: s ]      |
| 0b0001                                                | PA[35: s ]      |
| 0b0010                                                | PA[39: s ]      |
| 0b0011                                                | PA[41: s ]      |
| 0b0100                                                | PA[43: s ]      |
| 0b1000 , supported when FEAT_RME_GPC3 is implemented. | PA[45: s ]      |
| 0b1001 , supported when FEAT_RME_GPC3 is implemented. | PA[46: s ]      |
| 0b0101                                                | PA[47: s ]      |
| 0b0110                                                | PA[51: s ]      |
| 0b0111 , supported when FEAT_RME_GPC3 is implemented. | PA[55: s ]      |

The bit position s has the same value as the supported L0GPT entry size, decoded from GPCCR\_EL3.L0GPTSZ. If GPCCR\_EL3.PPS is configured for a range smaller than or equal to the range advertised in GPCCR\_EL3.L0GPTSZ, then the level 0 table contains only one entry, at offset zero from the configured table base.

RRSHYW

The following table describes how the level 1 table is indexed by PA bits:

| GPCCR_EL3.PGS   | Size indicated   | Level 1 index   |
|-----------------|------------------|-----------------|
| 0b00            | 4KB              | PA[ s -1:16]    |
| 0b10            | 16KB             | PA[ s -1:18]    |
| 0b01            | 64KB             | PA[ s -1:20]    |

The bit position s has the same value as the supported L0GPT entry size, decoded from GPCCR\_EL3.L0GPTSZ.

ILJQCV

The following table shows how the amount of memory occupied by a level 1 table depends on GPCCR\_EL3.L0GPTSZ and GPCCR\_EL3.PGS:

| L0GPTSZ          | PGS=4KB   | PGS=16KB   | PGS=64KB   |
|------------------|-----------|------------|------------|
| 0b0000 , 30 bits | 128KB     | 32KB       | 8KB        |
| 0b0100 , 34 bits | 2MB       | 512KB      | 128KB      |
| 0b0110 , 36 bits | 8MB       | 2MB        | 512KB      |
| 0b1001 , 39 bits | 64MB      | 16MB       | 4MB        |

## D9.7.1 Ordering of memory accesses from GPT walks

ICLGHP

RCKTPD

If FEAT\_ETS2 is implemented, and a memory access RW1 is Ordered-before a second memory access RW2, then RW1 is also Ordered-before any translation table walk generated by RW2 that generates any of the following:

- ATranslation fault.
- An Address size fault.
- An Access flag fault.

For more information, see Ordering of memory accesses from translation table walks.

If FEAT\_RME is implemented, and a memory access RW1 is Ordered-before a second memory access RW2, then RW1 is also Ordered-before any GPT walk generated by RW2 that generates any of the following:

- AGPTwalk fault.
- AGPTaddress size fault.